{% extends 'base.html' %}

{% block head %}

  {% load static %}
  <link rel="stylesheet" href="{% static 'css/detail2.css' %}">
  <link rel="stylesheet" href="{% static 'css/diagrama.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-dark@5/dark.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
  <title>Inspección de vehículo</title>

{% endblock %}

{% block content %}

<div class="main-cont">
  <header class="head-cont animate__animated animate__fadeIn">
    <div class="logo">
        <img src="{% static 'images/aeto.svg' %}" alt="logo">
    </div>
  
    <h1>Inspección de vehículo</h1>
  </header>

  <main class="main__container">
    {% include 'inspeccion/config.html' %}

    {% include 'inspeccion/formulario.html' %}
  </main>
</div>

<script src="{% static 'js/inspeccion/index.js' %}" type="module"></script>

<script>
  document.addEventListener('DOMContentLoaded', (e) => {
    handlePresion();
    validateEconomic();
  })

  const validateEconomic = () => {
    const data = []
  }

  const handlePresion = () => {
    const inputs = document.querySelectorAll('input[name="presion"]');
    const tag = document.querySelectorAll('[data-tag-id]');

    inputs.forEach(input => {
      input.addEventListener('input', (e) => {
        let id = input.getAttribute('data-input-id');
        let tag = document.querySelector(`[data-tag-id="${id}"]`)
        let minPresion = parseFloat(input.getAttribute('data-presion-min'));
        let maxPresion = parseFloat(input.getAttribute('data-presion-max'));

        tag.textContent = input.value;

        if (tag.textContent.length === 0 ) {
          tag.textContent = 0;
        }

        if (parseFloat(tag.textContent) >= minPresion && parseFloat(tag.textContent) <= maxPresion) {
          tag.parentElement.classList.remove('bad');
          tag.parentElement.classList.add('good');
        } else {
          tag.parentElement.classList.remove('good');
          tag.parentElement.classList.add('bad');
        }

        let container = document.querySelector(`[data-container-id="${id}"]`);
        if (parseFloat(tag.textContent) > maxPresion) {
          container.querySelector('[data-icon-presion="Alta presion"]').classList.add('visible')
          container.querySelector('[data-icon-presion="Baja presión"]').classList.remove('visible')
        } else if (parseFloat(tag.textContent) < minPresion) {
          container.querySelector('[data-icon-presion="Alta presion"]').classList.remove('visible')
          container.querySelector('[data-icon-presion="Baja presión"]').classList.add('visible')
        } else if (parseFloat(tag.textContent) >= minPresion && parseFloat(tag.textContent) <= maxPresion) {
          container.querySelector('[data-icon-presion="Alta presion"]').classList.remove('visible')
          container.querySelector('[data-icon-presion="Baja presión"]').classList.remove('visible')
        }
        
      })
    })
  }
</script>

{% endblock %}